{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",

  // Base Configuration Presets
  // "config:recommended" - Renovate's recommended defaults (kept as baseline)
  extends: [
    "config:recommended",
    // Enable auto-merge for Renovate's own updates
    ":automergeDigest",
    ":automergeBranch"
  ],

  // Dependency Dashboard
  // Creates a GitHub issue to track all pending updates (default: true, shown for visibility)
  dependencyDashboard: true,
  dependencyDashboardTitle: "ðŸ¤– Dependency Updates Dashboard",

  // Update Schedule
  // Limit when Renovate creates PRs to avoid notification spam
  // Runs Monday-Friday before 3am (default: anytime)
  schedule: [
    "before 3am every weekday"
  ],

  // Timezone for schedule (default: UTC)
  timezone: "America/Los_Angeles",

  // PR Limits
  // Limit concurrent PRs to avoid overwhelming CI (default: 10 for branches, 2 for PRs)
  prConcurrentLimit: 5,
  branchConcurrentLimit: 10,

  // PR Behavior
  // Create PRs immediately instead of waiting for schedule (default: false)
  prCreation: "immediate",

  // Rebase PRs when behind base branch (default: "auto")
  rebaseWhen: "behind-base-branch",

  // Add labels to PRs for easier filtering (default: empty)
  labels: ["dependencies"],

  // Commit Message Configuration
  // Use semantic commit format with dependency type prefix
  semanticCommits: "enabled",
  commitMessagePrefix: "chore(deps):",
  commitMessageAction: "update",
  commitMessageTopic: "{{depName}}",

  // Automerge Configuration
  // Platform automerge uses GitHub's "auto-merge" feature (default: false)
  platformAutomerge: true,

  // Package-Specific Rules
  packageRules: [
    // ========================================================================
    // GitHub Actions - Auto-merge all updates
    // ========================================================================
    {
      description: "Auto-merge all GitHub Actions updates (safe, pinned by SHA)",
      matchManagers: ["github-actions"],
      automerge: true,
      automergeType: "pr",
      // Require status checks to pass before merging (default: false)
      automergeRequireAllStatusChecks: true
    },

    // ========================================================================
    // Nix Flake Inputs - Auto-merge minor/patch only
    // ========================================================================
    {
      description: "Auto-merge minor and patch updates for Nix flake inputs",
      matchManagers: ["nix"],
      matchUpdateTypes: ["minor", "patch"],
      automerge: true,
      automergeType: "pr",
      automergeRequireAllStatusChecks: true
    },

    // ========================================================================
    // Nix Flake Inputs - Manual review for major versions
    // ========================================================================
    {
      description: "Require manual review for major Nix flake updates",
      matchManagers: ["nix"],
      matchUpdateTypes: ["major"],
      automerge: false,
      // Add specific label for major updates
      labels: ["dependencies", "major-update"],
      // Request review from specific team/user if needed
      // reviewers: ["JacobPEvans"]
    },

    // ========================================================================
    // Lock File Maintenance - Auto-merge (low risk)
    // ========================================================================
    {
      description: "Auto-merge lock file maintenance (flake.lock updates)",
      matchUpdateTypes: ["lockFileMaintenance"],
      automerge: true,
      automergeType: "pr",
      automergeRequireAllStatusChecks: true,
      // Run lock file updates weekly (default: weekly)
      schedule: ["before 3am on Monday"]
    },

    // ========================================================================
    // Digest Updates - Auto-merge (SHA updates for pinned refs)
    // ========================================================================
    {
      description: "Auto-merge digest updates (SHA updates for pinned dependencies)",
      matchUpdateTypes: ["digest"],
      automerge: true,
      automergeType: "pr",
      automergeRequireAllStatusChecks: true
    },

    // ========================================================================
    // Pin Digests - Auto-merge (adds SHA pins to unpinned refs)
    // ========================================================================
    {
      description: "Auto-merge pin digest updates (adds SHA pins for security)",
      matchUpdateTypes: ["pin"],
      automerge: true,
      automergeType: "pr",
      automergeRequireAllStatusChecks: true
    },

    // ========================================================================
    // Group Updates - Reduce PR noise
    // ========================================================================
    {
      description: "Group all GitHub Actions updates into single PR",
      matchManagers: ["github-actions"],
      groupName: "GitHub Actions",
      // Optionally limit how often grouped PRs are created
      schedule: ["before 3am on Monday"]
    },

    // ========================================================================
    // Renovate Self-Updates - Auto-merge
    // ========================================================================
    {
      description: "Auto-merge Renovate's own updates",
      matchDatasources: ["docker"],
      matchPackageNames: ["renovate"],
      automerge: true,
      automergeType: "pr",
      automergeRequireAllStatusChecks: true
    }
  ],

  // Vulnerability Alerts
  // Enable Renovate to create PRs for security vulnerabilities (default: true, shown for visibility)
  vulnerabilityAlerts: {
    enabled: true,
    labels: ["security"],
    // Auto-merge security patches (use with caution)
    automerge: false,
    // Assign security PRs for immediate attention
    // assignees: ["JacobPEvans"]
  },

  // Regex Managers (if needed for custom dependency detection)
  // Useful for parsing custom version strings in shell scripts, etc.
  regexManagers: [],

  // Ignore Specific Dependencies
  // Use this to prevent updates for problematic packages
  ignoreDeps: [
    // Example: "some-broken-package"
  ],

  // Post-Upgrade Tasks
  // Run commands after updating dependencies (useful for code generation, etc.)
  postUpgradeTasks: {
    commands: [
      // Example: rebuild something after flake.lock changes
      // "nix flake check --no-build"
    ],
    fileFilters: [
      "**/*"
    ],
    executionMode: "branch"
  }
}
